# GitHub PR Phase Monitor Configuration

# Check interval - how often to check the repositories
# Supported formats:
#   - "30s" = 30 seconds
#   - "1m"  = 1 minute
#   - "5m"  = 5 minutes
#   - "1h"  = 1 hour
#   - "1d"  = 1 day
interval = "1m" # default

# Number of issues to display from repositories without open PRs
# Default is 10, but can be changed to any positive number (e.g., 5, 15, 20)
issue_display_limit = 10

# Timeout for "all PRs in phase3" state
# If all PRs remain in phase3 for this duration, the application will exit
# to prevent wasting API usage. Set to empty string "" to disable.
# Supported formats: "30s", "1m", "5m", "30m", "1h", "1d"
# Default: "30m" (30 minutes - safety priority)
all_phase3_timeout = "30m"

# Verbose mode - Print detailed configuration information
# When enabled, prints all settings at startup and per-repository settings during execution
# This helps detect configuration mistakes
# Default: false
verbose = false

# Note: This tool monitors user-owned repositories under the current GitHub user account
# It uses GraphQL API to efficiently fetch all repositories with open PRs
# Organization repositories are NOT included (YAGNI principle - keeping it simple)
# No need to specify repository directories!

# Rulesets - Configure execution settings per repository or group of repositories
# Rulesets are applied in order, with later rulesets overriding earlier ones
# Each ruleset can specify different execution settings for different repositories
#
# IMPORTANT: Execution control flags (enable_execution_*) can ONLY be specified
# inside [[rulesets]] sections. Global flags are no longer supported.
# Use 'repositories = ["all"]' to apply settings to all repositories.
#
# You can also configure phase3_merge and assign_to_copilot settings per ruleset,
# allowing different repositories to have different merge or auto-assign behaviors.
#
# Example configurations:
#
# [[rulesets]]
# name = "All repositories default - dry-run mode"
# repositories = ["all"]  # "all" matches all repositories
# enable_execution_phase1_to_phase2 = false  # Set to true to mark draft PRs as ready
# enable_execution_phase2_to_phase3 = false  # Set to true to post phase2 comments
# enable_execution_phase3_send_ntfy = false  # Set to true to send ntfy notifications
# enable_execution_phase3_to_merge = false   # Set to true to merge phase3 PRs
#
# [[rulesets]]
# name = "Enable automation for test repository"
# repositories = ["owner/test-repo"]  # Specific repository with owner/name format
# enable_execution_phase1_to_phase2 = true
# enable_execution_phase2_to_phase3 = true
# enable_execution_phase3_send_ntfy = true
# enable_execution_phase3_to_merge = true
#
# [[rulesets]]
# name = "Enable only notifications for production repos"
# repositories = ["owner/prod-repo1", "owner/prod-repo2"]  # Multiple repositories
# enable_execution_phase1_to_phase2 = false
# enable_execution_phase2_to_phase3 = false
# enable_execution_phase3_send_ntfy = true
# enable_execution_phase3_to_merge = false
#
# You can also use just the repository name without the owner (matches any owner):
# [[rulesets]]
# name = "Example with repo name only"
# repositories = ["my-repo"]  # Matches any owner/my-repo
# enable_execution_phase1_to_phase2 = true
# enable_execution_phase3_to_merge = true
#
# Per-ruleset phase3_merge and assign_to_copilot on/off configuration:
#
# You can enable or disable phase3_merge and assign_to_copilot features per repository
# by adding simple boolean flags in rulesets. When enabled, the feature uses the global
# settings defined in [phase3_merge] and [assign_to_copilot] sections.
#
# [[rulesets]]
# name = "Enable merge for specific repo"
# repositories = ["owner/test-repo"]
# enable_execution_phase3_to_merge = true
# enable_phase3_merge = true  # Use global [phase3_merge] settings for this repo
#
# [[rulesets]]
# name = "Enable auto-assign for another repo"
# repositories = ["owner/another-repo"]
# enable_assign_to_copilot = true  # Use global [assign_to_copilot] settings for this repo


# ntfy.sh notification settings (optional)
# Sends mobile notifications when phase3 is detected
# Notifications include a clickable action button to open the PR
[ntfy]
enabled = false  # Set to true to enable notifications
topic = "<your-ntfy.sh-topic-name>" # Use a hard-to-guess topic name for security
message = "PR is ready for review: {url}"  # Message template, {url} will be replaced with PR URL
priority = 4  # Optional: notification priority (1=min, 3=default, 4=high, 5=max)

# Phase3 merge settings (optional)
# Automatically merge PRs when they reach phase3 (ready for review)
# Before merging, a comment defined below will be posted to the PR
[phase3_merge]
enabled = false  # Set to true to enable automatic merging (also requires enable_execution_phase3_to_merge = true)
comment = "All checks passed. Merging PR."  # Comment to post before merging
automated = false  # Set to true to use browser automation to click the merge button
automation_backend = "selenium"  # Backend to use: "selenium" or "playwright" (automated mode only)
wait_seconds = 10  # How long to wait after opening the browser before clicking (automated mode only)
browser = "edge"  # Browser to use: Selenium: "edge", "chrome", "firefox" / Playwright: "chromium", "firefox", "webkit"
headless = false  # Run browser in headless mode (no visible window, automated mode only)
# Note: Feature branch is automatically deleted after successful merge

# Auto-assign "good first issue" issues to Copilot (optional)
# When enabled, the tool will automatically open the issue in your browser.
# You can then manually click the "Assign to Copilot" button on the GitHub issue page.
# 
# Automated mode (requires Selenium or Playwright):
# If 'automated' is set to true, the tool will use browser automation to
# automatically click the buttons after waiting for the specified time.
# 
# Selenium backend:
#   Install: pip install selenium webdriver-manager
#   Browsers: "edge", "chrome", or "firefox"
# 
# Playwright backend:
#   Install: pip install playwright && playwright install
#   Browsers: "chromium", "firefox", or "webkit"
[assign_to_copilot]
enabled = false  # Set to true to enable auto-assignment feature
assign_lowest_number_issue = false  # Set to true to assign the issue with the lowest number (regardless of "good first issue" label)
automated = false  # Set to true to enable automated button clicking
automation_backend = "selenium"  # Backend to use: "selenium" or "playwright"
wait_seconds = 10  # How long to wait after opening the browser before clicking (automated mode only)
browser = "edge"  # Browser to use: Selenium: "edge", "chrome", "firefox" / Playwright: "chromium", "firefox", "webkit"
headless = false  # Run browser in headless mode (no visible window, automated mode only)
